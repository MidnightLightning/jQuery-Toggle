<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 
<head>
	<title>jQuery slide toggle</title>
	<meta http-equiv="content-type" content="text/html;charset=utf-8" />
	<meta http-equiv="content-style-type" content="text/css" />
	<style type="text/css">
		.sliderContainer { box-sizing:border-box; border:solid 2px #CCC; background-color:#F00; height:18px; width:75px; cursor:pointer; margin:0; padding:0; position:relative; overflow:hidden; }
		.sliderContainer .sliderTrack { position:absolute; width:500px; height:10px; padding:0; margin:0; top:-3px; }
		/* Create data URL: uuencode -m pin.png foobar */
		.sliderContainer .sliderPin {
			background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAstJREFUeNpMU01LVGEUPvfOnY87Oo46pjZDBoFgEy5aKFQEbaSFm/5DqxaakH/A1oFG9AM0iahF5KKlQYi0iNBJTGoE5wPme5rvjztzZ3qeN5NeOLzvfc97zvM855yrra6uytjYmHi9XnG73Wp3uVzCZdu2WSgUjKXl5drTtbV+Op2WarUquq5Lo9H4ex4aGlIXDodD/H4/7YbP59t0Op1FTdMa8Fc21tdLbct6h4Dbr7a3nZtbW1qtVpN6vS6OhYUFGRwclMnJSUHgSr/ffx8IBG7i2xwZGRECIKkbAOFOp/MQ3+5f0eh+NBq1Q8Fg37G4uCgDAwOkvoSHzycmJnRKKRaLAvqSz+elVCopSQTC+Y6m6ybk7CeTyY5O+r1e7xoczyzLkkwmo4IpiT4u3pfLZaU7FAqJrmmPr05N3YPL1NvttoDaE8MwXAwGNUFm6Xa7gruLBDS+Jdvp6Wnd4/E8gstvVCoVOu+z8qRMupTA8+zsrErAYqEjihXfoUYEuAXXsMFqNpvNK2wlEVB9SpJcLie7u7sCqhIYHZX/l9c0pWfbfiS7ZDA76UKGchKd2pnIh6IFg0HxoxONZlNarZZio2ThPZLoBimjOFFICTNIGbRDI9v6b6AUKulXwTibzZJ1rmvbLZ1U0aqPp6enF8gMpvGsEkAS5kO6QE3E4/L96IgMvsDVUV0A+stIJNKIxWJKCovFYO5crAnb+BMd2tvbE4B1EfcWrpqDfT2MRKoYpCTkPKBGDowJyqwH6efB8tvBgXzY2ZHj42PW4wUSfEaCtIF5VyDI+qZeqzVSqdRGPB6/PD4+LjQWLpFISOzsTH6Xy4WOZW00W61PiMnAKtrc3JyifXB4yLGDdM8U0Ff6vd5d6A4zO/YoZHxF4GswSuEqCyvAmtr8/LzqPyftx8kJ6fBfZvmHz3f3efvb1Azjj1FlJ6/PzPT+CDAACECetz6ulRIAAAAASUVORK5CYII=");
			width:16px; height:16px;
			position:absolute; top:2px; left:0px;
		}
		.sliderContainer .sliderOnText, .sliderContainer .sliderOffText { display:inline-block; box-sizing:border-box; text-align:center; line-height:1em; font-weight:bold; font-size:10pt; width:50%; padding:3px 0; }
		.sliderContainer .sliderOnText { color:#FFF; background-color:#66F; text-align:right; padding-right:13px; }
		.sliderContainer .sliderOffText { color:#000; background-color:#FFF; text-align:left; padding-left:13px; }
		
	</style>
</head>
	<input type="checkbox" id="slide" name="slideMe" value="on" />
<body>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>!window.jQuery && document.write(unescape('%3Cscript src="inc/jquery-1.7.1.js"%3E%3C/script%3E'))</script>
<script type="text/javascript">
// jQuery plugin patterns: http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/
// jQuery widgets: http://ajpiano.com/widgetfactory
(function($){
	var methods = {
		init: function(options) {
			console.log(arguments);
			var base = this; // use 'base' instead of 'this' for clarity.
			var $base = $(base);
			$base.options = $.extend({
				checkedText: 'On',
				uncheckedText: 'Off',
			}, options);
			console.log(options);
			
			var $sliderContainer = $base.wrap('<div class="sliderContainer" />').parent();
			$sliderContainer.css('width', options.width).append('<div class="sliderTrack"><div class="sliderOnText"></div><div class="sliderPin"></div><div class="sliderOffText"></div></div>');
			//$base.attr('type', 'hidden'); // Change input into a hidden field
			$base.css('display', 'none'); // Hide base checkbox
			$sliderContainer.find('.sliderOnText').html($base.options.checkedText).on("mousedown", { direction: 'turnOff'}, methods.toggle);
			$sliderContainer.find('.sliderOffText').html($base.options.uncheckedText).on("mousedown", { direction: 'turnOn'}, methods.toggle);

			var $track = $sliderContainer.find('.sliderTrack');
			var $pin = $sliderContainer.find('.sliderPin');
			$pin.css('left', Math.floor($track.width()/2-$pin.width()/2) + "px"); // Set pin location
			
			if ($base.prop("checked")) {
				$track.css('left',  Math.floor($track.width()/2 * -1 + $sliderContainer.width() - $pin.width()/2 - 3) + 'px'); // Move to "on" position
			} else {
				$track.css('left', Math.floor($track.width()/2 * -1 + $pin.width()/2 + 3) + 'px'); // Move to "off" position
			}
			
			//$sliderContainer.on("mousedown", methods.dragStart);
		},
		toggle: function(e) {
			if (typeof e.data.direction == 'undefined') {
				// Toggle current state
			} else {
				if (e.data.direction == 'turnOn') {
					methods._turnOn($(this).parent());
				} else {
					methods._turnOff($(this).parent());
				}
			}
		},
		_turnOn: function($el) {
			console.log("Turn on");
			var $container = $el.parent();
			var $pin = $container.find('.sliderPin');
			$el.css('left', Math.floor($el.width()/2 * -1 + $pin.width()/2 + 3) + 'px'); // Reset to "off" position
			$el.animate({left: Math.floor($el.width()/2 * -1 + $container.width() - $pin.width()/2 - 3) + 'px'}, 'fast'); // Slide to "on" position
			console.log($container.find('input'));
			$container.find('input').prop('checked', true); // Check the hidden checkbox
			console.log($container.find('input').prop('checked'));
		},
		_turnOff: function($el) { // Passed element is the slider track to move
			console.log("Turn off");
			var $container = $el.parent();
			var $pin = $container.find('.sliderPin');
			$el.css('left', Math.floor($el.width()/2 * -1 + $container.width() - $pin.width()/2 - 3) + 'px'); // Reset to "on" position
			$el.animate({left: Math.floor($el.width()/2 * -1 + $pin.width()/2 + 3) + 'px'}, 'fast'); // Slide to "off" position
			$container.find('input').prop('checked', false); // Uncheck the hidden checkbox
		},
		drag: function() {
			
		},
		dragStart: function(e) {
			console.log(this, e);
		}
	};
	$.fn.slider = function(options) {
		console.log(arguments);
		return this.each(function() {
			return methods.init.apply(this, arguments);
		})
	}
})(jQuery);

$(document).ready(function() {
	$('input#slide').slider({width: '50px'});
});
</script>
</body>
</html>
